# 倍增法

倍增法（英语：binary lifting），顾名思义就是翻倍。它能够使线性的处理转化为**对数级**的处理，大大地优化时间复杂度。

这个方法在很多算法中均有应用，其中最常用的是 **RMQ** 问题和求 **LCA**（最近公共祖先）。

## 原理

倍增算法和ST表

线段上有n个点，给定每个点i往右边跳1步能最远覆盖的点jump[i]

已知从任意点出发都能到达最后的点，并且在i < j时，必有jump[i] <= jump[j]

1）如何构建一张表

可以查询从任意点出发：跳1步、跳2步、跳4步、跳8步..每回最远能到达的点

也就是可以查询，从任意点i出发，任意跳(2的p次方)步，最远能到达的点

2）如何快速计算任意的两点之间，最少跳几步能到达？



构建出的表叫做**ST表(Sparse Table)**

构建方式：

st [i] [0] = jump[i]

st [i] [p] = st [[i] [p-1]] [p-1]，p代表：跳2的p次方步，表大小为n * logn

利用ST表，从x到y跳跃的过程中，先从最大步长开始，每次步长减少一半去尝试，最终得到答案

时间复杂度O(log n)



ST表的适用范围

如果A区间和B区间可能有重叠的部分

但是并不影响A+B区间的答案，能通过 A区间答案 和 B区间答案 就加工出来

那么对应的区间询问，就是一个可重复贡献问题

例如：区间最大值，区间最小值、区间公约数等，但是区间求和就不符合这个要求

再例如：区间按位与、区间按位或，ST表都能高效地解决



ST表的优势和劣势

RMQ问题(Range Maximum/Minimum Query)可以用ST表维护，也可以用线段树等结构维护

ST表的优势：构建过程时间复杂度O(n * logn)，单次查询时间复杂度O(1)，代码量较小

ST表的劣势：需要空间较大，能维护的信息非常有限，不支持修改操作